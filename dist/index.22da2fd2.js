const t=["left","right"],e={passive:!0},i=["toggle","open","close"],s={documentMinSwipeX:10,documentSwipeRange:40,responsive:!1,position:"left",backdropOpacity:.3};function n(t){const e=document.createElement("div");return e.setAttribute(t,""),e}function o(t,e){return t&&"boolean"==typeof e?t.sidebarjsListener=e:!!t.sidebarjsListener}function a(t,e){for(let s=0;s<i.length;s++){const n=i[s],o=document.querySelectorAll(`[sidebarjs-${n}="${t}"]`);for(let t=0;t<o.length;t++)e(o[t],n)}}function r(t){return t.target.hasAttribute("sidebarjs-backdrop")}function h(t){t&&t()}class c{isVisible(){return this.component.classList.contains("sidebarjs--is-visible")}destroy(){for(this.removeNativeGestures(),this.container.removeEventListener("transitionstart",this._onTransitionStart),this.container.removeEventListener("transitionend",this._onTransitionEnd),this.backdrop.removeEventListener("click",this.close),this.removeNativeOpenGestures(),this.removeAttrsEventsListeners(this.component.getAttribute("sidebarjs")),this.removeComponentClassPosition();this.container.firstElementChild;)this.component.appendChild(this.container.firstElementChild);this.component.removeChild(this.container),this.component.removeChild(this.backdrop),Object.keys(this).forEach((t=>this[t]=null))}setPosition(e){this.addComponentClass("sidebarjs--is-moving"),this.position=t.indexOf(e)>=0?e:"left";const i=1===(document.querySelectorAll("[sidebarjs]")||[]).length;this.removeComponentClassPosition(i),this.addComponentClass(`sidebarjs--${this.position}`),this.responsive&&this.mainContent&&this.mainContent.classList.add(`sidebarjs-content--${this.position}`),setTimeout((()=>this.component&&this.removeComponentClass("sidebarjs--is-moving")),200)}addAttrsEventsListeners(t){a(t,((t,i)=>{o(t)||(t.addEventListener("click",this[i],e),o(t,!0))}))}removeAttrsEventsListeners(t){a(t,((t,e)=>{o(t)&&(t.removeEventListener("click",this[e]),o(t,!1))}))}setSwipeGestures(t){if("boolean"!=typeof t)throw new Error(`You provided a ${typeof t} value but setSwipeGestures needs a boolean value.`);this.nativeSwipe&&(t?this.addNativeGestures():this.removeNativeGestures(),this.nativeSwipeOpen&&(t?this.addNativeOpenGestures():this.removeNativeOpenGestures()))}getTransitionType(){const t=this.isVisible();return{open:t&&!this._wasVisible,close:!t&&this._wasVisible,isVisible:t}}toggleTransitionClass(t){this.toggleComponentClass("sidebarjs--transition-end",!t),this.toggleComponentClass("sidebarjs--transition-start",t)}addTransitionListener(){this._wasVisible=this.isVisible(),this.container.addEventListener("transitionstart",this._onTransitionStart,e),this.container.addEventListener("transitionend",this._onTransitionEnd,e)}removeComponentClassPosition(e){for(let i=0;i<t.length;i++)this.removeComponentClass(`sidebarjs--${t[i]}`),e&&this.mainContent&&this.mainContent.classList.remove(`sidebarjs-content--${t[i]}`)}hasLeftPosition(){return"left"===this.position}hasRightPosition(){return"right"===this.position}transcludeContent(){for(;this.component.firstChild;)this.container.appendChild(this.component.firstChild);for(;this.component.firstChild;)this.component.removeChild(this.component.firstChild);this.component.appendChild(this.container),this.component.appendChild(this.backdrop)}addNativeGestures(){this.nativeGestures.forEach(((t,i)=>{this.component.addEventListener(i,t,e)}))}removeNativeGestures(){this.nativeGestures.forEach(((t,e)=>{this.component.removeEventListener(e,t)}))}addNativeOpenGestures(){this.nativeOpenGestures.forEach(((t,i)=>{document.addEventListener(i,t,e)}))}removeNativeOpenGestures(){this.nativeOpenGestures.forEach(((t,e)=>{document.removeEventListener(e,t)}))}moveSidebar(t){this.addComponentClass("sidebarjs--is-moving"),this.applyStyle(this.container,"transform",`translate(${t}px, 0)`,!0),this.updateBackdropOpacity(t)}updateBackdropOpacity(t){const e=(1-Math.abs(t)/this.container.clientWidth)/this.backdropOpacityRatio;this.setBackdropOpacity(e)}setBackdropOpacity(t){this.applyStyle(this.backdrop,"opacity",t.toString())}setResponsive(){if(!this.responsive&&this.mainContent)throw new Error("You provide a [sidebarjs-content] element without set {responsive: true}");if(this.responsive&&!this.mainContent)throw new Error("You have set {responsive: true} without provide a [sidebarjs-content] element");this.addComponentClass("sidebarjs--responsive")}applyStyle(t,e,i,s){if(this.isStyleMapSupported)t.attributeStyleMap.set(e,i);else if(t.style[e]=i,s){const s="webkit"+e.charAt(0).toUpperCase()+e.slice(1);t.style[s]=i}}clearStyle(t){this.isStyleMapSupported?t.attributeStyleMap.clear():t.removeAttribute("style")}addComponentClass(t){this.component.classList.add(t)}removeComponentClass(t){this.component.classList.remove(t)}toggleComponentClass(t,e){this.component.classList.toggle(t,e)}constructor(t={}){this.toggle=()=>{this.isVisible()?this.close():this.open()},this.open=()=>{this.addComponentClass("sidebarjs--is-visible"),this.setBackdropOpacity(this.backdropOpacity)},this.close=()=>{this.removeComponentClass("sidebarjs--is-visible"),this.clearStyle(this.backdrop)},this._onTouchStart=t=>{this.initialTouch=t.touches[0].pageX},this._onTouchMove=t=>{const e=-(this.initialTouch-t.touches[0].clientX);this.container.clientWidth+(this.hasLeftPosition()?e:-e)<=this.container.clientWidth&&(this.touchMoveSidebar=Math.abs(e),this.moveSidebar(e))},this._onTouchEnd=()=>{this.removeComponentClass("sidebarjs--is-moving"),this.clearStyle(this.container),this.clearStyle(this.backdrop),this.touchMoveSidebar>this.container.clientWidth/3.5?this.close():this.open(),this.initialTouch=null,this.touchMoveSidebar=null},this._onSwipeOpenStart=t=>{if(r(t))return;const e=t.touches[0].clientX;(this.hasLeftPosition()?e:document.body.clientWidth-e)<this.documentSwipeRange&&this._onTouchStart(t)},this._onSwipeOpenMove=t=>{if(!r(t)&&this.initialTouch&&!this.isVisible()){const e=t.touches[0].clientX-this.initialTouch,i=this.hasLeftPosition(),s=i?e:-e,n=this.container.clientWidth-s;n>0&&s>=this.documentMinSwipeX&&(this.openMovement=i?-n:n,this.moveSidebar(this.openMovement))}},this._onSwipeOpenEnd=()=>{this.openMovement&&(this.openMovement=null,this._onTouchEnd())},this._onTransitionStart=()=>{const{open:t,close:e}=this.getTransitionType();(t||e)&&this.toggleTransitionClass(!0)},this._onTransitionEnd=()=>{const{open:t,close:e,isVisible:i}=this.getTransitionType();(t||e)&&this.toggleTransitionClass(!1),t?(this._wasVisible=!0,h(this._emitOnOpen)):e&&(this._wasVisible=!1,h(this._emitOnClose)),this._emitOnChangeVisibility&&this._emitOnChangeVisibility({isVisible:i})},this.nativeGestures=new Map([["touchstart",this._onTouchStart],["touchmove",this._onTouchMove],["touchend",this._onTouchEnd]]),this.nativeOpenGestures=new Map([["touchstart",this._onSwipeOpenStart],["touchmove",this._onSwipeOpenMove],["touchend",this._onSwipeOpenEnd]]);const i=Object.assign(Object.assign({},s),t),o=i.container&&i.backdrop;var a;if(this.component=i.component||document.querySelector("[sidebarjs]"),this.container=o?i.container:n("sidebarjs-container"),this.backdrop=o?i.backdrop:n("sidebarjs-backdrop"),this.documentMinSwipeX=i.documentMinSwipeX,this.documentSwipeRange=i.documentSwipeRange,this.nativeSwipe=!1!==i.nativeSwipe,this.nativeSwipeOpen=!1!==i.nativeSwipeOpen,this.isStyleMapSupported=Boolean(window.CSS&&window.CSS.number),this.responsive=Boolean(i.responsive),this.mainContent=(a=i.mainContent)?(a.setAttribute("sidebarjs-content",""),a):document.querySelector("[sidebarjs-content]"),this.backdropOpacity=i.backdropOpacity,this.backdropOpacityRatio=1/i.backdropOpacity,this._emitOnOpen=i.onOpen,this._emitOnClose=i.onClose,this._emitOnChangeVisibility=i.onChangeVisibility,!o)try{this.transcludeContent()}catch(t){throw new Error("You must define an element with [sidebarjs] attribute")}this.setSwipeGestures(!0),(this.responsive||this.mainContent)&&this.setResponsive(),this.setPosition(i.position),this.addAttrsEventsListeners(this.component.getAttribute("sidebarjs")),this.addTransitionListener(),this.backdrop.addEventListener("click",this.close,e)}}new c({});
//# sourceMappingURL=index.22da2fd2.js.map
